<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>2015年帝都伙食最差加班大楼排行榜公布</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no,target-densityDpi=device-dpi">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" href="css/swiper.min.css">
    <script type="text/javascript" src="js/jquery-2.1.3.min.js"></script>
    <script type="text/javascript" src="js/weixin.js"></script>
</head>
<body>
    <div class="main">
        <!--加载页面-->
        <div class="load_page">
            <div class="load_box">
                <div class="bread_box">
                    <img src="images/bread1.png" class="cur">
                    <img src="images/bread2.png">
                    <img src="images/bread3.png">
                    <img src="images/bread4.png">
                </div>
                <div class="box">
                    <ul class="load_dot"></ul>
                </div>
            </div>
            <div class="star"></div>
        </div>
        <!--加载页面-->
        <!--首页页面-->
        <div class="new_page">
            <div class="logo"></div>
            <div class="moon"></div>
            <div class="worst"></div>
            <div class="butn_box">
                <div class="butn1"></div>
                <div class="butn2"></div>
            </div>
        </div>
        <!--首页页面-->
        <div class="swiper-container swiper-container2">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <div class="jmg_box">
                        <img src="images/page1_1_1.png" class="img_box_ct">
                    </div>
                    <div class="dog">
                        <div class="tears"><img src="images/page1_3.png"></div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <div class="mangran">
                        <img src="images/page2_1_1.png" class="mg_in">
                    </div>
                    <div class="zuiqiu"><img src="images/page2_2.png"></div>
                    <div class="page_light"><img src="images/page2_light.png"></div>
                </div>
                <div class="swiper-slide">
                    <div class="mangran mangran2">
                        <img src="images/page3_1_1.png" class="mg_in">
                    </div>
                    <div class="zuiqiu"><img src="images/page3_2.png"></div>
                    <div class="kiss"><img src="images/kiss.png"></div>
                </div>
                <div class="swiper-slide">
                    <div class="mangran mangran3">
                        <img src="images/page4_1_1.png" class="mg_in">
                    </div>
                    <div class="zuiqiu"><img src="images/page4_2.png"></div>
                    <div class="light2"><img src="images/light2.png"></div>
                </div>
                <div class="swiper-slide">
                    <div class="mangran mangran4">
                        <img src="images/page6_1_1.png" class="mg_in">
                    </div>
                    <div class="zuiqiu zuiqiu2"><img src="images/page6_2.png"></div>
                    <div class="star"></div>
                </div>
                <div class="swiper-slide">
                    <div class="py_box">
                        <p><img src="images/page7_1.png"></p>
                        <p><img src="images/page7_2.png"></p>
                        <p><img src="images/page7_3.png"></p>
                    </div>
                    <div class="sunlight"><img src="images/sunlight.png"></div>
                </div>
                <div class="swiper-slide">
                    <div class="light_d">
                        <img src="images/light.png">
                    </div>
                    <div class="sekg">
                        <div class="py_box">
                            <p><img src="images/page8_1.png"></p>
                            <p><img src="images/page8_2.png"></p>
                            <p><img src="images/page8_3.png"></p>
                            <p><img src="images/page8_4.png"></p>
                        </div>
                        <div class="page8_5"><img src="images/page8_5.png"></div>
                        <div class="bread_food"><img src="images/page8_6.png"></div>
                        <div class="next_page_butn"><img src="images/page8_new2.png"></div>
                    </div>
                    <div class="sek_next">
                        <div class="sek_next_in">
                            <img src="images/page8_new1.png">
                            <a href="javascript:;" class="sek_next_butn"></a>
                        </div>
                    </div>
                </div>
                <div class="swiper-slide">
                    <ul class="bad_ul_list">
                        <li>1.北京嘉里中心</li>
                        <li>2.东方广场东二座</li>
                        <li>3.乐视大厦</li>
                        <li>4.朝外Soho</li>
                        <li>5.百度大厦</li>
                        <li>6.东升科技园北领地</li>
                        <li>7.望京Soho中心</li>
                        <li>8.恒通国际创新园C9蓝色光标</li>
                        <li>9.北京财富中心写字楼</li>
                        <li>10.朝林广场</li>
                    </ul>
                    <form>
                        <select class="selectAddr">
                            <option value="东方广场东二座">东方广场东二座</option>
                            <option value="恒通国际创新园C9蓝色光标">恒通国际创新园C9蓝色光标</option>
                            <option value="北辰世纪中心">北辰世纪中心</option>
                            <option value="百度大厦">百度大厦</option>
                            <option value="东升科技园北领地">东升科技园北领地</option>
                            <option value="华丽大厦">华丽大厦</option>
                            <option value="乐视大厦">乐视大厦</option>
                            <option value="北辰世纪中心">北辰世纪中心</option>
                            <option value="北京财富中心写字楼">北京财富中心写字楼</option>
                            <option value="得实大厦">得实大厦</option>
                            <option value="东方广场东三安永大楼">东方广场东三安永大楼</option>
                            <option value="朝外Soho">朝外Soho</option>
                            <option value="维亚大厦">维亚大厦</option>
                            <option value="北京嘉里中心">北京嘉里中心</option>
                            <option value="银河Soho">银河Soho</option>
                            <option value="互联网金融中心">互联网金融中心</option>
                            <option value="金宝大厦">金宝大厦</option>
                            <option value="望京Soho中心">望京Soho中心</option>
                            <option value="朝林广场">朝林广场</option>
                            <option value="1">其他</option>
                        </select>
                        <input type="button" value="" class="tijiao">
                    </form>
                </div>
                <div class="swiper-slide">
                    <a href="javascript:;" class="share_butn"></a>
                    <div class="share_box">
                        <img src="images/shareLayout.png">
                    </div>
                </div>
            </div>
            <div id="up_arrow"></div>
        </div>
        <div id="music_butn" class="cur"></div>
        <!-- <audio src="http://124.167.236.31/7xkxd4.media1.z0.glb.clouddn.com/h520150515/jiabg/music.mp3?wsiphost=local" style="display:none;" class="music" loop="loop"></audio> -->
    </div>
    <script src="js/swiper.min.js"></script>
    <script>
        $(function(){
            var aniArr=null;//存放所有图片的数组
            var len2=0;
            var num=0;///加载页面初始
            var bread_num=0;///加载面包初始
            var cir_num=0;///加载面包初始
            var cir_str="";//加载页面小圆点
            var mySwiper2=null;
            var version = navigator.userAgent;
            var wx = 'MicroMessenger';
            var ad = 'Android';
            var ip = 'iPhone';
            var success = false;
            var iosph = false;
            var andph = false;
            $(".main").css("transform","scale("+$(window).height()/1008+")");
            if(version.indexOf(wx) >= 0 ){
                success = true;
                $("<script>",{
                    src: 'http://twttmob.com/count.js',
                    type: 'text/javascript'
                }).appendTo('body');
            }else{
                // if(window.location != "http://h5.twttmob.com/mylove/"){
                //     window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx00473a02d601f4c1&redirect_uri=http://cswechat.tpv-tech.com/AOCWechat/redirectToGamePageNew.do?urlto=http%3a%2f%2fh5.rkastore.com%2fhxjy%2findex.php%3fs%3d%2fHome%2fSession%2findex&response_type=code&scope=snsapi_userinfo&state=STATE&connect_redirect=1#wechat_redirect";
                // }
            };

            //////////////加载页面
            var arr=[
                "images/bread1.png",
                "images/bread2.png",
                "images/bread3.png",
                "images/bread4.png",
                "images/btn1_bg.png",
                "images/btn1_bg_bg.png",
                "images/btn2_bg.png",
                "images/dog.jpg",
                "images/down_arrow.png",
                "images/kiss.png",
                "images/last_bg.jpg",
                "images/light.png",
                "images/light2.png",
                "images/loading_bg.jpg",
                "images/loadingBread.png",
                "images/loadingDot1.png",
                "images/loadingTxt.png",
                "images/logo.png",
                "images/mcbg_1.png",
                "images/mcbg_2.png",
                "images/moon.png",
                "images/moonLight.png",
                "images/new_bg.jpg",
                "images/new_bg9.jpg",
                "images/new_text.png",
                "images/new_text_bg.png",
                "images/new_txt.png",
                "images/page1_1.png",
                "images/page1_1_1.png",
                "images/page1_2.png",
                "images/page1_3.png",
                "images/page1_bg.jpg",
                "images/page2_1.png",
                "images/page2_1_1.png",
                "images/page2_2.png",
                "images/page2_bg.jpg",
                "images/page2_light.png",
                "images/page3_1.png",
                "images/page3_1_1.png",
                "images/page3_2.png",
                "images/page3_bg.jpg",
                "images/page4_1.png",
                "images/page4_1_1.png",
                "images/page4_2.png",
                "images/page4_bg.jpg",
                "images/page6_1.png",
                "images/page6_1_1.png",
                "images/page6_2.png",
                "images/page6_bg.jpg",
                "images/page7_1.png",
                "images/page7_2.png",
                "images/page7_3.png",
                "images/page7_bg.jpg",
                "images/page8_1.png",
                "images/page8_2.png",
                "images/page8_3.png",
                "images/page8_4.png",
                "images/page8_5.png",
                "images/page8_6.png",
                "images/page8_bg.jpg",
                "images/page8_new1.png",
                "images/page8_new2.png",
                "images/shareLayout.png",
                "images/star1.png",
                "images/star2.png",
                "images/sunlight.png"
            ];
            for(var i=0;i<arr.length;i++){
                var oImg=new Image();
                oImg.onload=function(){
                    progress();
                }
                oImg.onerror=function(){
                    progress();
                }
                oImg.src=arr[i];
                function progress(){
                    num++;
                    if(num==arr.length){
                        $(".load_page").hide();
                        //$(".music").get(0).play();
                    }
                }
            }
            //////////////加载页面

            ///加载页面包动画
            setInterval(function(){
                if(bread_num<$(".bread_box img").length-1){
                    bread_num++;
                }else{
                    bread_num=0;
                }
                $(".bread_box img").eq(bread_num).addClass('cur').siblings().removeClass('cur');   
            }, 700);
            ///加载页面包动画

            ///////播放音乐
            $("#music_butn").on("touchstart",function(){
                if($(".music").get(0).paused){
                    $("#music_butn").addClass("cur");
                    $(".music").get(0).play();
                }else{
                    $("#music_butn").removeClass("cur");
                    $(".music").get(0).pause();
                } 
            })
            ///////播放音乐

            ////加载等待小圆点
            for(var i=0;i<6;i++){
                cir_str+="<li></li>";
            }
            $(".load_dot").append(cir_str);
            $(".load_dot li").eq(cir_num).addClass('cur');
            setInterval(function(){
                if(cir_num<$(".load_dot li").length-1){
                    cir_num++;
                    $(".load_dot li").eq(cir_num).addClass('cur');
                }else{
                    cir_num=0;
                    $(".load_dot li").eq(cir_num).addClass('cur').siblings().removeClass("cur");
                }
            }, 200);
            ////加载等待小圆点
            
            //
            $(".butn_box .butn1").on("touchstart",function(){
                $(this).parents(".new_page").hide();
                aniArr[0].inAn();
                setInterval(function(){
                    //mySwiper2.slideNext();
                }, 1500);
            });

            //狗出现之后流眼泪
            $(".dog").on("transitionend webkitTransitionEnd",function(){
                $(this).find(".tears").css({
                    "animation": 'tears_ani 0.8s infinite linear'
                });
            });

            ///////////////
            $(".next_page_butn").on("touchstart",function(){
                $(".sek_next").show();
            });

            ///分享按钮
            $(".share_butn").on("touchstart",function(){
                $(".share_box").show();
            });
            $(".share_box").on("touchstart",function(){
                $(this).hide();
            });
            ///////////////////////
            mySwiper2 = new Swiper('.swiper-container2', {
                direction: 'vertical',
                mousewheelControl: true,
                watchSlidesProgress: true,
                //noSwiping : true,
                followFinger:false,
                onInit: function(swiper) {
                    len2=$(".swiper-container2 .swiper-slide").length-1;
                    aniArr=[
                        {
                            inAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(0).children(".jmg_box").addClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(0).children(".dog").addClass('cur');
                            },
                            outAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(0).children(".jmg_box").removeClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(0).children(".dog").removeClass('cur');
                            }
                        },
                        {
                            inAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(1).children(".mangran").addClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(1).children(".zuiqiu").addClass('cur');
                            },
                            outAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(1).children(".mangran").removeClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(1).children(".zuiqiu").removeClass('cur');
                            }
                        },
                        {
                            inAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(2).children(".mangran").addClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(2).children(".zuiqiu").addClass('cur');
                            },
                            outAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(2).children(".mangran").removeClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(2).children(".zuiqiu").removeClass('cur');
                            }
                        },
                        {
                            inAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(3).children(".mangran").addClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(3).children(".zuiqiu").addClass('cur');
                            },
                            outAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(3).children(".mangran").removeClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(3).children(".zuiqiu").removeClass('cur');
                            }
                        },
                        {
                            inAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(4).children(".mangran").addClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(4).children(".zuiqiu").addClass('cur');
                            },
                            outAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(4).children(".mangran").removeClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(4).children(".zuiqiu").removeClass('cur');
                            }
                        },
                        {
                            inAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(5).children(".py_box").find("p").each(function(index, el) {
                                    $(this).addClass('cur');
                                });
                                $(".swiper-container2 .swiper-slide").eq(5).children(".sunlight").addClass('cur');
                            },
                            outAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(5).children(".py_box").find("p").each(function(index, el) {
                                    $(this).removeClass('cur');
                                });
                                $(".swiper-container2 .swiper-slide").eq(5).children(".sunlight").removeClass('cur');
                            }
                        },
                        {
                            inAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(6).find(".py_box").find("p").each(function(index, el) {
                                    $(this).addClass('cur');
                                });
                                $(".swiper-container2 .swiper-slide").eq(6).find(".page8_5").addClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(6).find(".bread_food").addClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(6).find(".next_page_butn").addClass('cur');
                                $(".swiper-container2 .swiper-slide").eq(6).find(".light_d").addClass('cur');
                            },
                            outAn:function(){
                                $(".swiper-container2 .swiper-slide").eq(6).find(".py_box").find("p").each(function(index, el) {
                                    $(this).removeClass('cur');
                                    $(".swiper-container2 .swiper-slide").eq(6).find(".page8_5").removeClass('cur');
                                    $(".swiper-container2 .swiper-slide").eq(6).find(".bread_food").removeClass('cur');
                                    $(".swiper-container2 .swiper-slide").eq(6).find(".next_page_butn").removeClass('cur');
                                    $(".swiper-container2 .swiper-slide").eq(6).find(".light_d").removeClass('cur');
                                });
                            }
                        },
                    ]
                    swiper.myactive = 0;
                    swiper.prevNum=0;
                    $(".swiper-container2 .swiper-slide").each(function(index, el) {
                        if(aniArr[index]){
                            aniArr[index].outAn();
                        }
                    });
                    $(".swiper-container2 .swiper-slide").each(function(index, el) {
                        $(this).children("div").eq(1).on("transitionend webkitTransitionEnd",function(){
                            $(this).removeClass('cur2').css({
                                "transformOrigin":209+"px -"+160+"px",
                                "animation": 'rotate_center 3s linear 0s infinite',

                            });
                        });
                    });
                    //////
                    $(".sek_next_butn").on("touchstart",function(){
                        mySwiper2.slideNext();
                        $(this).parents(".sek_next").hide();
                    });


                    /////伙食大楼最差排行榜按钮
                    $(".butn2").on("touchstart",function(){
                        $(this).parents(".new_page").addClass('cur');
                        mySwiper2.slideTo(len2, 800, false);
                    });
                },
                onProgress: function(swiper) {
                    for (var i = 0; i < swiper.slides.length; i++) {
                        var slide = swiper.slides[i];
                        var progress = slide.progress;
                        var translate, boxShadow;
                        translate = progress * swiper.height * 0.8;
                        scale = 1 - Math.min(Math.abs(progress * 0.2), 1);
                        boxShadowOpacity = 0;
                        slide.style.boxShadow = '0px 0px 10px rgba(0,0,0,' + boxShadowOpacity + ')';
                        if (i == swiper.myactive) {
                            es = slide.style;
                            es.webkitTransform = es.MsTransform = es.msTransform = es.MozTransform = es.OTransform = es.transform = 'translate3d(0,' + (translate) + 'px,0) scale(' + scale + ')';
                            es.zIndex=0;
                        }else{
                            es = slide.style;
                            es.webkitTransform = es.MsTransform = es.msTransform = es.MozTransform = es.OTransform = es.transform ='';
                            es.zIndex=1;   
                        }
                    }
                },
                onTouchStart:function(swiper,event){
                    //console.log(event.changedTouches[0].clientY)
                    swiper.prevNum=event.changedTouches[0].clientY;
                },
                onTouchMove:function(swiper,event){
                    if(event.changedTouches[0].clientY<swiper.prevNum){
                        //alert(swiper.activeIndex)
                        $(".swiper-container2 .swiper-slide").eq(swiper.activeIndex).addClass('swiper-no-swiping')
                    };
                    
                },
                onTouchEnd:function(swiper,event){
                },
                onTransitionEnd: function(swiper, speed) {
                    swiper.myactive = swiper.activeIndex;
                   //  if(swiper.activeIndex>swiper.prevNum&&swiper.activeIndex==2){
                   //      alert("message")
                   //      swiper.prevNum=swiper.activeIndex;
                   //    swiper.slideTo(2, 100, false);
                   // };
                    $(".swiper-container2 .swiper-slide").each(function(index, el) {
                        if(aniArr[index]){
                            aniArr[index].outAn();
                        }
                    });
                    if(aniArr[swiper.activeIndex]){
                        aniArr[swiper.activeIndex].inAn();
                    }
                    if(swiper.activeIndex==6){
                        $(".swiper-container2 .swiper-slide").eq(swiper.activeIndex).addClass('swiper-no-swiping');
                    }
                    if(swiper.activeIndex==len2){
                        $("#up_arrow").hide();
                        $(".pic28").addClass('cur3');
                    }else{
                        if(swiper.activeIndex==6){
                            $("#up_arrow").hide();
                        }else{
                            $("#up_arrow").show();
                        }
                        $(".pic28").removeClass('cur3');
                    }
                },
                onSetTransition: function(swiper, speed) {
                    for (var i = 0; i < swiper.slides.length; i++) {
                            es = swiper.slides[i].style;
                            es.webkitTransitionDuration = es.MsTransitionDuration = es.msTransitionDuration = es.MozTransitionDuration = es.OTransitionDuration = es.transitionDuration = speed + 'ms';
                    }
                }
            });
        });
    </script>
<script>
    var url = location.href.split('#')[0];
    $.ajax({
        url: 'http://twttmob.com/active.php/Token/index',
        type: 'POST',
        dataType: 'json',
        data: {url: url},
        complete: function(xhr, textStatus) {
            //called when complete
        },
        success: function(json) {
            Weixin(json)
        },
        error: function(json) {}
    })

    function Weixin(json) {
        wx.config({
            debug: false,
            appId: 'wx9ef75f25acc4a2dc',
            timestamp: json.timestamp,
            nonceStr: json.noncestr,
            signature: json.signature,
            jsApiList: [
                'checkJsApi',
                'onMenuShareTimeline',
                'onMenuShareAppMessage'
            ]
        })
        wx.ready(function() {
            wx.checkJsApi({
                jsApiList: [
                    'onMenuShareTimeline',
                    'onMenuShareAppMessage'
                ],
                success: function(res) {
                    //alert(JSON.stringify(res));
                }
            })
            wx.onMenuShareTimeline({
                title: '2015年帝都伙食最差加班大楼排行榜公布', // 分享标题
                link: '', // 分享链接
                imgUrl: 'http://h5.twttmob.com/jiabangou/images/logo.png', // 分享图标
                success: function () { 
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () { 
                    
                }
            });
            wx.onMenuShareAppMessage({
                title: '2015年帝都伙食最差加班大楼排行榜公布', // 分享标题
                desc: '2015年帝都伙食最差加班大楼排行榜公布', // 分享描述
                link: '', // 分享链接
                imgUrl: 'http://h5.twttmob.com/jiabangou/images/logo.png', // 分享图标
                success: function () { 
                    // 用户确认分享后执行的回调函数
                },
                cancel: function () { 
                    // 用户取消分享后执行的回调函数
                }
            });
        })
    }
</script>
</body>
</html>